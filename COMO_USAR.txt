â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    SISTEMA DE CONSULTA DETRAN-CE
                    Como Usar e Executar o CÃ³digo
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“‹ ÃNDICE
â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. VisÃ£o Geral
2. Requisitos
3. InstalaÃ§Ã£o
4. ConfiguraÃ§Ã£o
5. Como Executar
6. Arquivos Gerados
7. Estrutura do CÃ³digo
8. SoluÃ§Ã£o de Problemas


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
1. VISÃƒO GERAL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Este sistema automatiza a consulta de multas, IPVA e licenciamento no site do
DETRAN-CE. Ele:

âœ“ Acessa automaticamente o site do DETRAN
âœ“ Consulta mÃºltiplos veÃ­culos em sequÃªncia
âœ“ Extrai informaÃ§Ãµes detalhadas de cada multa
âœ“ Calcula valores totais automaticamente
âœ“ Gera arquivo CSV com os resultados
âœ“ Organiza tudo em planilha Excel formatada
âœ“ Emite boletos automaticamente


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
2. REQUISITOS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

SOFTWARE NECESSÃRIO:
â”œâ”€ Python 3.8 ou superior
â”œâ”€ Ambiente virtual Python (venv)
â””â”€ Navegador Chromium (instalado automaticamente pelo Playwright)

BIBLIOTECAS PYTHON:
â”œâ”€ playwright (automaÃ§Ã£o do navegador)
â”œâ”€ pandas (manipulaÃ§Ã£o de dados)
â”œâ”€ openpyxl (criaÃ§Ã£o de arquivos Excel)
â””â”€ numpy (processamento numÃ©rico)


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
3. INSTALAÃ‡ÃƒO
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PASSO 1: Instalar dependÃªncias
   Execute no terminal PowerShell:
   
   C:\Users\Samuel\Downloads\detran-main\detran-main\venv\Scripts\python.exe -m pip install -r requirements.txt

PASSO 2: Instalar navegadores do Playwright
   Execute:
   
   C:\Users\Samuel\Downloads\detran-main\detran-main\venv\Scripts\python.exe -m playwright install


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
4. CONFIGURAÃ‡ÃƒO
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Abra o arquivo: detran_manual.py

Localize a seÃ§Ã£o de configuraÃ§Ã£o (linhas 8-12):

VEICULOS = [
    {"placa": "SBA7F09", "renavam": "01365705622"},
    {"placa": "TIF1J98", "renavam": "01450499292"},
]

COMO CONFIGURAR:
â”œâ”€ Substitua as placas pelos seus veÃ­culos
â”œâ”€ Substitua os renavams correspondentes
â”œâ”€ Adicione mais veÃ­culos seguindo o mesmo padrÃ£o
â””â”€ NÃ£o remova as aspas nem as vÃ­rgulas


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
5. COMO EXECUTAR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

MODO 1: Executar Consulta Completa
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Abra o PowerShell e execute:

   cd C:\Users\Samuel\Downloads\detran-main\detran-main
   C:/Users/Samuel/Downloads/detran-main/detran-main/venv/Scripts/python.exe detran_manual.py

O QUE ACONTECE:
â”œâ”€ Navegador abre automaticamente (nÃ£o feche!)
â”œâ”€ Sistema acessa o DETRAN-CE
â”œâ”€ Consulta cada veÃ­culo configurado
â”œâ”€ Extrai dados das multas
â”œâ”€ Calcula valores totais
â”œâ”€ Marca multas e emite boletos
â”œâ”€ Salva tudo no arquivo CSV
â””â”€ Aguarda vocÃª pressionar ENTER para fechar


MODO 2: Organizar Excel (apÃ³s consulta)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Execute:

   C:/Users/Samuel/Downloads/detran-main/detran-main/venv/Scripts/python.exe organizar_excel.py

O QUE ACONTECE:
â”œâ”€ LÃª o arquivo resultado_detran.csv
â”œâ”€ Separa cada multa em uma linha
â”œâ”€ Extrai: AIT, DescriÃ§Ã£o, Datas, Valores
â”œâ”€ Formata profissionalmente
â””â”€ Gera arquivo Excel organizado


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
6. ARQUIVOS GERADOS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

resultado_detran.csv
â”œâ”€ Arquivo bruto com todas as consultas
â”œâ”€ Uma linha por veÃ­culo consultado
â”œâ”€ ContÃ©m todos os dados extraÃ­dos
â””â”€ Formato: CSV separado por vÃ­rgulas

resultado_detran_organizado.xlsx
â”œâ”€ Planilha Excel formatada profissionalmente
â”œâ”€ Uma linha por multa individual
â”œâ”€ Colunas organizadas:
â”‚  â”œâ”€ Data/Hora Consulta
â”‚  â”œâ”€ Placa
â”‚  â”œâ”€ Renavam
â”‚  â”œâ”€ AIT (cÃ³digo da multa)
â”‚  â”œâ”€ DescriÃ§Ã£o da InfraÃ§Ã£o
â”‚  â”œâ”€ Data InfraÃ§Ã£o
â”‚  â”œâ”€ Vencimento
â”‚  â”œâ”€ Valor Original
â”‚  â”œâ”€ Valor com Desconto
â”‚  â”œâ”€ IPVA Pendente
â”‚  â””â”€ Licenciamento Pendente
â””â”€ FormataÃ§Ã£o com cores, bordas e larguras ajustadas


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
7. ESTRUTURA DO CÃ“DIGO
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

detran_manual.py - SCRIPT PRINCIPAL
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

FUNÃ‡Ã•ES PRINCIPAIS:

log(msg)
â”œâ”€ Exibe mensagens no console
â””â”€ Facilita acompanhamento do processo

detectar_pendencias(texto)
â”œâ”€ Analisa texto da pÃ¡gina do DETRAN
â”œâ”€ Identifica quantidade de multas
â”œâ”€ Detecta IPVA e Licenciamento pendentes
â””â”€ Retorna dicionÃ¡rio com resultados

extrair_motivos_multas(page)
â”œâ”€ LÃª tabela de multas na pÃ¡gina
â”œâ”€ Extrai descriÃ§Ã£o de cada multa
â”œâ”€ Calcula valor total somando valores
â”œâ”€ Remove linhas de cabeÃ§alho e TOTAL
â””â”€ Retorna lista de motivos e valor total

marcar_checkboxes_multas(page)
â”œâ”€ Localiza checkboxes na tabela
â”œâ”€ Marca todas as multas encontradas
â””â”€ Retorna sucesso/falha

clicar_emitir(page)
â”œâ”€ Localiza botÃ£o "Emitir"
â”œâ”€ Clica para gerar boleto
â””â”€ Aguarda processamento

processar_veiculo(browser, veiculo, indice)
â”œâ”€ FunÃ§Ã£o principal de processamento
â”œâ”€ Navega atÃ© o DETRAN
â”œâ”€ Preenche formulÃ¡rio
â”œâ”€ Consulta dados
â”œâ”€ Extrai informaÃ§Ãµes
â”œâ”€ Emite boletos
â””â”€ Salva no CSV

main()
â”œâ”€ Ponto de entrada do programa
â”œâ”€ Inicia navegador
â”œâ”€ Processa cada veÃ­culo
â”œâ”€ Adiciona intervalos entre consultas
â””â”€ Fecha ao final


organizar_excel.py - ORGANIZADOR DE PLANILHA
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

PROCESSO:

1. Leitura do CSV
   â”œâ”€ Usa pandas para ler resultado_detran.csv
   â””â”€ Valida estrutura de colunas

2. ExtraÃ§Ã£o de Dados
   â”œâ”€ Separa multas por "|"
   â”œâ”€ Usa regex para extrair campos:
   â”‚  â”œâ”€ AIT: [A-Z]\d+ antes de --
   â”‚  â”œâ”€ DescriÃ§Ã£o: texto entre -- e data
   â”‚  â”œâ”€ Datas: padrÃ£o dd/mm/yyyy
   â”‚  â””â”€ Valores: padrÃ£o R$ xxx,xx
   â””â”€ Cria uma linha por multa

3. FormataÃ§Ã£o Excel
   â”œâ”€ CabeÃ§alho azul com texto branco
   â”œâ”€ Bordas em todas as cÃ©lulas
   â”œâ”€ Alinhamento centralizado
   â”œâ”€ Larguras de colunas otimizadas
   â””â”€ Primeira linha congelada


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
8. SOLUÃ‡ÃƒO DE PROBLEMAS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PROBLEMA: Navegador nÃ£o abre
SOLUÃ‡ÃƒO:
â”œâ”€ Reinstale navegadores: python -m playwright install
â””â”€ Verifique se o Playwright estÃ¡ instalado

PROBLEMA: Erro "Permission denied" no Excel
SOLUÃ‡ÃƒO:
â”œâ”€ Feche o arquivo resultado_detran_organizado.xlsx
â””â”€ Execute o script novamente

PROBLEMA: NÃ£o encontra multas
SOLUÃ‡ÃƒO:
â”œâ”€ Verifique placa e renavam configurados
â”œâ”€ Confirme se hÃ¡ multas no site do DETRAN
â””â”€ Aguarde o site carregar completamente

PROBLEMA: Valores nÃ£o aparecem no Excel
SOLUÃ‡ÃƒO:
â”œâ”€ Verifique se o CSV foi gerado corretamente
â”œâ”€ Execute organizar_excel.py novamente
â””â”€ Confira se hÃ¡ dados na coluna motivos_multas

PROBLEMA: Script para no meio
SOLUÃ‡ÃƒO:
â”œâ”€ Verifique conexÃ£o com internet
â”œâ”€ Aumente tempo de espera (edite time.sleep)
â””â”€ Execute novamente (o CSV acumula dados)


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
OBSERVAÃ‡Ã•ES IMPORTANTES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âš ï¸ INTERVALOS ENTRE CONSULTAS
   O sistema aguarda 20-35 segundos entre consultas para evitar bloqueio
   pelo site do DETRAN. NÃƒO reduza esses intervalos!

âš ï¸ NÃƒO FECHE O NAVEGADOR
   O navegador Ã© controlado automaticamente. Deixe-o aberto durante todo
   o processo.

âš ï¸ DADOS ACUMULADOS
   O arquivo CSV acumula dados. Se quiser comeÃ§ar do zero, delete o
   arquivo resultado_detran.csv antes de executar.

âœ“ BACKUP
   Sempre faÃ§a backup dos arquivos CSV e Excel antes de executar novamente.

âœ“ VERIFICAÃ‡ÃƒO
   Sempre confira os dados gerados com o site do DETRAN para garantir
   precisÃ£o.


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
SUPORTE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Em caso de dÃºvidas:
1. Leia este arquivo completo
2. Verifique os logs no console
3. Confira se seguiu todos os passos de instalaÃ§Ã£o
4. Revise a configuraÃ§Ã£o de veÃ­culos no cÃ³digo


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                            FIM DO GUIA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
